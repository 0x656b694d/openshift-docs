// Module included in the following assemblies:
//
// persistent-storage-csi-vsphere.adoc
//

[id="persistent-storage-csi-vsphere-install-issues_{context}"]
= Removing an upstream vSphere CSI Operator Driver

If you have installed a non-Red Hat vSphere Container Storage Interface (CSI) Operator Driver, and then try to update your cluster to {product-title} 4.11 or later, {product-title} may prevent the update. This occurs because {product-title} 4.10 has a built-in version of the vSphere CSI Operator Driver, and thus after upgrading to 4.10, your cluster may have updates to the next major versions, such as 4.11 of {product-title} disabled if there is a non-Red Hat provided vSphere CSI driver present in the cluster. (product-title} 4.10 clusters are still fully supported and upgrades to bug fix versions of 4.10 (4.10.z) are not blocked, but you must correct this state before updates to next major version of {product-title} can be enabled.

To correct this issue and update the cluster, you need to uninstall the upstream vSphere CSI Operator Driver. Removing the upstream vSphere CSI driver does not require deletion of associated persistent volume (PV) objects, and no data loss should occur.

[NOTE]
====
These instructions may not be complete, so consult the vendor or community provider uninstall guide to ensure removal of the driver and components.
====

To uninstall the upstream vSphere CSI Operator Driver:

. Delete the upstream vSphere CSI driver (VMware vSphere Container Storage Plug-in) Deployment and Daemonset objects.
. Delete the configmap and secret objects that were installed previously with the upstream vSphere CSI Operator Driver.
. Delete the upstream vSphereCSI driver `CSIDriver` object:
+
[output, terminal]
----
~ $ oc delete CSIDriver csi.vsphere.vmware.com
----
+
[output, terminal]
----
csidriver.storage.k8s.io "csi.vsphere.vmware.com" deleted
----

After you have completed removal of upstream vSphere CSI driver, the {product-title} update automatically resumes.
