// Module included in the following assemblies:
//
// * monitoring/user-workload-monitoring.adoc

[id="making-the-prometheus-stack-monitor-the-workload_{context}"]
= Making the Prometheus stack monitor the workload

To use the metrics exposed by your workload, you need to make the Prometheus Cluster Monitoring stack monitor the workload. You can do this using a service monitor or a pod monitor. This procedure shows how to create a ServiceMonitor for the workload.

.Procedure

. Create a YAML file for the service monitor configuration. In this example, the file is called `example-app-service-monitor.yaml`.
+

. Fill the file with the configuration for creating the service monitor:
+
[source,yaml]
----
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  labels:
    k8s-app: prometheus-example-monitor
  name: prometheus-example-monitor
  namespace: ns1
spec:
  endpoints:
  - interval: 30s
    port: web
    scheme: http
  selector:
    matchLabels:
      app: prometheus-example-app
----
+
This configuration makes the Prometheus Cluster Monitoring monitor the metrics exposed by the sample application deployed in "Deploying a sample application", which includes the single `version` metric.

. Apply the configuration file to the cluster:
+
----
$ oc apply -f example-app-service-monitor.yaml
----
+
It will take some time to deploy the service monitor.

. You can check that the service monitor is running:
+
----
$ oc -n ns1 get servicemonitor
NAME                         AGE
prometheus-example-monitor   81m
----
