[[using-images-using-dot-net-core]]
= .NET Core
{product-author}
{product-version}
:data-uri:
:icons:
:experimental:
:toc: macro
:toc-title:

toc::[]

[[benefits-of-using-dot-net-core]]
== Benefits of Using .NET Core

link:http://developers.redhat.com/dotnet/[.NET Core] is a general purpose
development platform featuring automatic memory management and modern
programming languages. It allows users to build high-quality applications
efficiently. .NET Core is available on Red Hat Enterprise Linux (RHEL 7) and
{product-title} via certified containers. .NET Core offers:

* The ability to follow a microservices-based approach, where some components are
built with .NET and others with Java, but all can run on a common, supported
platform in Red Hat Enterprise Linux and {product-title}.
* The capacity to more easily develop new .NET Core workloads on Windows;
customers are able to deploy and run on either Red Hat Enterprise Linux or
Windows Server.
* A heterogeneous data center, where the underlying infrastructure is capable of
running .NET applications without having to rely solely on Windows Server.
* Access to many of the popular development frameworks such as .NET, Java, Ruby,
and Python from within {product-title}.

[[dot-net-core-supported-versions]]
== Supported Versions

The link:https://access.redhat.com/support/policy/updates/net-core[.NET Core Life Cycle] lists the currently supported versions of .NET Core.

[[dot-net-core-installing-images]]
== Images

The images are available through the Red Hat Registry.

If you ran a standard installation, the `dotnet` image stream will be present.
To include the latest supported versions you can link:https://access.redhat.com/documentation/en-us/net_core/2.1/html-single/getting_started_guide/#install_imagestreams[install]
the link:https://github.com/redhat-developer/s2i-dotnetcore/blob/master/dotnet_imagestreams.json[.NET image streams].

[[s2i-images-dot-net-build-process]]
== Build Process
include::using_images/s2i_images/topics/build_process.adoc[]

[[dot-net-core-configuration]]
== Environment Variables

The .NET Core images support several environment variables, which you can
set to control the build behavior of your .NET Core application.

[NOTE]
====
You must set environment variables that control build behavior in the S2I build
configuration or in the *_.s2i/environment_* file to make them
available to the build steps.
====

.NET Core Environment Variables
[cols="4a,6a,6a",options="header"]
|===

|Variable Name |Description |Default

|`DOTNET_STARTUP_PROJECT`
|Selects projects to run. This must be a project file (for example, *_csproj_* or
*_fsproj_*) or a folder containing a single project file.
|`.`

|`DOTNET_ASSEMBLY_NAME`
|Selects the assembly to run. This must _not_ include the `.dll` extension. Set
this to the output assembly name specified in *_csproj_*
(`PropertyGroup`/`AssemblyName`).
|The name of the *_csproj_* file.

|`DOTNET_RESTORE_SOURCES`
|Specifies the space-separated list of *NuGet* package sources used during the
restore operation. This overrides all of the sources specified in the
*_NuGet.config_* file.
|

|`DOTNET_TOOLS`
|Specifies a list of .NET tools to install before building the application. To
install a specific version, add `@<version>` to the end of the package name.
|

|`DOTNET_NPM_TOOLS`
|Specifies a list of NPM packages to install before building the application.
|

|`DOTNET_TEST_PROJECTS`
|Specifies the list of test projects to test. This must be project files or
folders containing a single project file. `dotnet test` is invoked for each
item.
|

|`DOTNET_CONFIGURATION`
|Runs the application in `Debug` or `Release` mode. This value should be either
`Release` or `Debug`.
|`Release`

|`DOTNET_VERBOSITY`
|Specifies the verbosity of the dotnet build commands. When set, the
environment variables are printed at the start of the build. This variable can
be set to one of the msbuild verbosity values (`q[uiet]`, `m[inimal]`,
`n[ormal]`, `d[etailed]`, and `diag[nostic]`).
|

|`HTTP_PROXY`, `HTTPS_PROXY`
|Configures the HTTP/HTTPS proxy used when building and running the application.
|

|`NPM_MIRROR`
|Uses a custom NPM registry mirror to download packages during the build process.
|

|`ASPNETCORE_URLS`
|This variable is set to `\http://*:8080` to configure ASP.NET Core to use the
 port exposed by the image. Changing this is _not_ recommended.
|`\http://*:8080`

|`DOTNET_RM_SRC`
|When set to `true`, the source code is not included in the image.
|

|`DOTNET_SSL_DIRS`
|Used to specify a list of folders and files with additional SSL certificates to
trust. The certificates are trusted by each process that runs during the build
and all processes that run in the image after the build, including the
application that was built. The items can be absolute paths starting with `/` or
paths in the source repository (for example, certificates).
|

|`DOTNET_RESTORE_DISABLE_PARALLEL`
|When set to `true`, disables restoring multiple projects in parallel. This reduces
restore timeout errors when the build container is running with low CPU limits.
|`false`

|`DOTNET_INCREMENTAL`
|When set to `true`, the *NuGet* packages are kept so they can be re-used for an
incremental build.
|`false`

|`DOTNET_PACK`
|When set to `true`, creates a *_tar.gz_* file at *_/opt/app-root/app.tar.gz_*
that contains the published application.
|
|===

[[dot-net-quickly-deploy-applications]]
== Quickly Deploying Applications from .NET Core Source

[IMPORTANT]
====
The
link:https://github.com/redhat-developer/s2i-dotnetcore/blob/master/dotnet_imagestreams.json[.NET
image stream] must first be
link:https://access.redhat.com/documentation/en-us/net_core/2.1/html-single/getting_started_guide/#install_imagestreams[installed].
If you ran a standard installation, the image stream will be present.
====

An image can be used to build an application by running `oc new-app` against a
sample repository:

----
$ oc new-app dotnet:3.1~https://github.com/redhat-developer/s2i-dotnetcore-ex#dotnetcore-3.1 --context-dir app
----
